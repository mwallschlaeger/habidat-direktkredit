extends ../admin/layout
block admin-content
  a.btn.btn-default.btn-sm(href='/user/add') Neue*r Direktkreditgeber*in
  table.table.table-striped(id="datatable")
    thead
      tr
        th.col-md-1(rowspan="2") ID
        th.col-md-2(rowspan="2") Name
        th.col-md-3(rowspan="2") Adresse
        th.col-md-1.text-center(colspan="3") Verträge
        th.col-md-3.text-right(colspan="3") Gesamtbetrag
        th.col-md-1.text-center(rowspan="2") S
        th.col-md-1.text-center(rowspan="2") Aktionen
      tr
        th.col-md-1.text-center B
        th.col-md-1.text-center O
        th.col-md-1.text-center G
        th.col-md-1.text-right Bez.
        th.col-md-1.text-right Off.
        th.col-md-1.text-right Gek.
    tbody
      each user in users
        - aggregate = user.getAggregateNumbers()
        tr
          td= user.id 
          if (user.last_name)
            td= user.last_name + ", " + user.first_name
          else
            td= user.first_name
          td 
            | #{user.street} <br /> #{user.zip} #{user.place}
          td.text-center #[font.text-success(data-toggle="tooltip" title="Bezahlt")= aggregate.paid] 
          td.text-center #[font.text-danger(data-toggle="tooltip" title="Offen")= aggregate.open]
          td.text-center #[font.text-muted(data-toggle="tooltip" title="Gekündigt")= aggregate.terminated]
          td.text-right #[font.text-success(data-toggle="tooltip" title="Bezahlt") #{sprintf('%.2f', aggregate.paidSum)}]  
          td.text-right #[font.text-danger(data-toggle="tooltip" title="Offen") #{sprintf('%.2f', aggregate.openSum)}] 
          td.text-right #[font.text-muted(data-toggle="tooltip" title="Gekündigt") #{sprintf('%.2f', aggregate.terminatedSum)}]
          td.text-center #[font.text-muted(data-toggle="tooltip" title="Vertragsstatus (Complete/Open)")= aggregate.status]
          td.fit
              a.btn.btn-default.btn-sm(href='/user/show/'+user.id) #[span.glyphicon.glyphicon-search]
              a.btn.btn-default.btn-sm(href='/user/edit/'+user.id) #[span.glyphicon.glyphicon-pencil]
              
